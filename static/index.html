<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BananaStore Window</title>
    <link rel="stylesheet" href="/static/styles.css" />
    <!-- Phosphor Icons v2.1.1 (MIT License) — https://phosphoricons.com -->
    <link rel="stylesheet" href="/static/fonts/phosphor/style.css" />
  </head>
  <body style="margin:0">
    <div class="banana-store" id="bananaStore">
    <main class="stage">
      <section class="window-shell" id="windowShell" aria-label="Image generation window">
        <header class="window-titlebar" id="dragHandle">
          <svg class="titlebar-banana" viewBox="0 0 32 32" aria-hidden="true">
            <defs>
              <linearGradient id="tbBananaGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#ffe566"/>
                <stop offset="50%" stop-color="#ffc107"/>
                <stop offset="100%" stop-color="#e6a000"/>
              </linearGradient>
              <linearGradient id="tbPeelGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#fff176"/>
                <stop offset="100%" stop-color="#fdd835"/>
              </linearGradient>
              <filter id="tbGlow" x="-30%" y="-30%" width="160%" height="160%">
                <feGaussianBlur stdDeviation="1.2" result="blur"/>
                <feComposite in="SourceGraphic" in2="blur" operator="over"/>
              </filter>
            </defs>
            <g filter="url(#tbGlow)">
              <path d="M20 5c-1.5 4.5-4.5 10-10 14-2.5 1.8-5 2.8-7.2 3 1.5 2 4.2 3.2 7.2 3.2 5.5 0 11-3 14.5-8s4.5-10.5 3-15l-7.5 2.8z" fill="url(#tbBananaGrad)" stroke="#d4a017" stroke-width="0.6"/>
              <path d="M21.5 3c.4-1 0-2-.8-2.2-.6 0-1.2.6-1.5 1.6l1 2 1.3-1.4z" fill="url(#tbPeelGrad)" stroke="#c9a800" stroke-width="0.4"/>
              <path d="M17 9c-1 3-3.5 7-7 10" fill="none" stroke="rgba(255,255,255,0.55)" stroke-width="1" stroke-linecap="round"/>
            </g>
          </svg>
          <h1><span data-i18n="bs.titlebar_name">BananaStore</span> <span class="titlebar-tagline">— <span data-i18n="bs.titlebar_tagline">Where Ideas Go Bananas</span></span></h1>
          <span class="bs-about" tabindex="0" role="button" data-i18n-aria="bs.about_label" aria-label="About"><i class="ph ph-info"></i><span class="bs-about-tip"><strong data-i18n="bs.titlebar_name">BananaStore</strong><br><span class="bs-about-sub" data-i18n="bs.titlebar_tagline">Where Ideas Go Bananas</span><br><span class="bs-about-legal">&copy; 2026 Michael Ikemann</span></span></span>
        </header>

        <div class="window-body">
          <nav class="mobile-tabs" id="mobileTabs">
            <button type="button" class="mobile-tab active" data-tab="create"><i class="ph ph-paint-brush-broad"></i> <span data-i18n="bs.tab_create">Create</span></button>
            <button type="button" class="mobile-tab" data-tab="result"><i class="ph ph-image"></i> <span data-i18n="bs.tab_result">Result</span></button>
          </nav>
          <div class="layout-grid" data-active-tab="create">
            <form id="generatorForm" class="panel controls">
              <h2><i class="ph ph-paint-brush-broad"></i> <span data-i18n="bs.heading_create">Create</span></h2>

              <div class="field-group">
                <span class="field-label" data-i18n="bs.label_provider">Provider</span>
                <div class="provider-group" id="providerGroup"></div>
              </div>

              <div class="option-row">
                <div class="option-row-inline">
                  <div class="option-group">
                    <span class="field-label"><i class="ph ph-star"></i> <span data-i18n="bs.label_quality">Quality</span></span>
                    <div class="option-pills" id="qualityPills"></div>
                  </div>
                  <div class="option-group">
                    <span class="field-label"><i class="ph ph-frame-corners"></i> <span data-i18n="bs.label_ratio">Ratio</span></span>
                    <div class="option-pills" id="ratioPills"></div>
                  </div>
                  <div class="option-group" id="formatGroup" hidden>
                    <span class="field-label"><i class="ph ph-file-image"></i> <span data-i18n="bs.label_format">Format</span></span>
                    <div class="option-pills" id="formatPills"></div>
                  </div>
                  <div class="option-group" id="modelGroup" hidden>
                    <span class="field-label"><i class="ph ph-cpu"></i> <span data-i18n="bs.label_model">Model</span></span>
                    <div class="option-pills" id="modelPills"></div>
                  </div>
                </div>
              </div>

              <hr class="section-divider" />

              <label class="description-label">
                <span class="field-label"><i class="ph ph-chat-text"></i> <span data-i18n="bs.label_description">Description</span></span>
                <div class="description-wrap">
                  <textarea id="description" name="description" rows="6" data-i18n-placeholder="bs.placeholder_description" placeholder="Describe what to generate"></textarea>
                  <div class="clear-desc-wrap">
                    <button type="button" id="clearDescriptionButton" class="input-icon-btn clear-desc-btn" data-i18n-title="bs.clear_description_title" title="Clear description" hidden>
                      <i class="ph ph-x" style="font-size:14px"></i>
                    </button>
                  </div>
                  <div class="voice-btn-stack">
                    <button type="button" id="voiceButton" class="input-icon-btn" data-i18n-title="bs.voice_btn_title" title="Talk me through your image idea">
                      <i class="ph ph-microphone" style="font-size:18px"></i>
                    </button>
                  </div>
                </div>
              </label>
              <input id="referenceImages" type="file" accept="image/*" multiple hidden />
              <input id="cameraInput" type="file" accept="image/*" capture="environment" hidden />

              <div class="primary-actions">
                <button type="submit" id="generateButton" class="generate-btn"><i class="ph ph-sparkle"></i> <span data-i18n="bs.btn_generate">Generate</span></button>
                <button type="button" id="aiNarrationToggle" class="secondary speaker-toggle" aria-pressed="true" data-i18n-title="bs.ai_voice_on_title" title="AI voice on">
                  <i class="ph ph-speaker-high" style="font-size:17px" aria-hidden="true"></i>
                </button>
              </div>
              <p id="status" class="status" data-i18n="bs.status_ready">Ready.</p>
            </form>

            <section class="panel output">
              <h2><i class="ph ph-image"></i> <span data-i18n="bs.heading_generated">Generated</span></h2>
              <div class="preview" id="previewWrap">
                <div class="progress-overlay" id="progressOverlay" hidden>
                  <svg class="banana-loader" viewBox="0 0 200 200" aria-hidden="true">
                    <defs>
                      <radialGradient id="glowGrad" cx="50%" cy="50%" r="50%">
                        <stop offset="0%" stop-color="#ffe082" stop-opacity="0.6"/>
                        <stop offset="100%" stop-color="#ffe082" stop-opacity="0"/>
                      </radialGradient>
                      <linearGradient id="bananaGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#ffe566"/>
                        <stop offset="50%" stop-color="#ffc107"/>
                        <stop offset="100%" stop-color="#e6a000"/>
                      </linearGradient>
                      <linearGradient id="peelGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#fff176"/>
                        <stop offset="100%" stop-color="#fdd835"/>
                      </linearGradient>
                      <filter id="bananaGlow" x="-40%" y="-40%" width="180%" height="180%">
                        <feGaussianBlur stdDeviation="6" result="blur"/>
                        <feComposite in="SourceGraphic" in2="blur" operator="over"/>
                      </filter>
                    </defs>
                    <circle class="loader-pulse" cx="100" cy="100" r="70" fill="url(#glowGrad)"/>
                    <circle class="loader-orbit" cx="100" cy="100" r="60" fill="none" stroke="rgba(255,193,7,0.15)" stroke-width="2" stroke-dasharray="8 12"/>
                    <circle class="loader-ring" cx="100" cy="100" r="60" fill="none" stroke="rgba(255,224,130,0.35)" stroke-width="4" stroke-linecap="round" stroke-dasharray="80 200"/>
                    <circle class="loader-ring-inner" cx="100" cy="100" r="48" fill="none" stroke="rgba(255,183,77,0.2)" stroke-width="3" stroke-linecap="round" stroke-dasharray="50 160"/>
                    <g class="loader-banana-group" filter="url(#bananaGlow)">
                      <path class="loader-banana-body" d="M118 62c-4 12-12 28-28 38-14 9-30 12-42 10 4 6 12 10 22 10 16 0 32-8 42-22s14-30 10-44l-4 8z" fill="url(#bananaGrad)" stroke="#d4a017" stroke-width="1.2"/>
                      <path class="loader-banana-peel" d="M122 54c1-3 0-6-2-7-2 0-4 2-5 5l3 6 4-4z" fill="url(#peelGrad)" stroke="#c9a800" stroke-width="0.8"/>
                      <path class="loader-banana-highlight" d="M110 72c-3 8-9 18-18 26" fill="none" stroke="rgba(255,255,255,0.5)" stroke-width="2" stroke-linecap="round"/>
                    </g>
                    <circle class="loader-sparkle s1" cx="140" cy="55" r="2.5" fill="#fff9c4"/>
                    <circle class="loader-sparkle s2" cx="60" cy="120" r="2" fill="#ffe082"/>
                    <circle class="loader-sparkle s3" cx="150" cy="130" r="1.8" fill="#fff176"/>
                    <circle class="loader-sparkle s4" cx="55" cy="70" r="2.2" fill="#ffecb3"/>
                    <circle class="loader-sparkle s5" cx="130" cy="150" r="1.5" fill="#ffd54f"/>
                    <circle class="loader-dot d1" cx="100" cy="40" r="3" fill="#ffb74d" opacity="0.8"/>
                    <circle class="loader-dot d2" cx="160" cy="100" r="3" fill="#ffb74d" opacity="0.8"/>
                    <circle class="loader-dot d3" cx="100" cy="160" r="3" fill="#ffb74d" opacity="0.8"/>
                    <circle class="loader-dot d4" cx="40" cy="100" r="3" fill="#ffb74d" opacity="0.8"/>
                  </svg>
                  <p class="loader-text" data-i18n="bs.status_generating">Generating image...</p>
                  <button type="button" id="cancelButton" class="cancel-btn"><i class="ph ph-x"></i> <span data-i18n="bs.btn_cancel">Cancel</span></button>
                </div>
                <button type="button" id="fullSizeButton" class="preview-action-btn full-size-btn" data-i18n-title="bs.view_full_size_title" title="View 100%" hidden>
                  <i class="ph ph-arrows-out" style="font-size:16px"></i>
                </button>
                <img id="previewImage" alt="Generated preview" hidden />
                <p id="emptyPreview" data-i18n="bs.empty_preview">Your generated image will appear here.</p>
              </div>
              <div class="preview-bar" id="previewBar" hidden>
                <p id="imageHint" class="image-hint" title=""></p>
                <button type="button" id="downloadButton" class="download-btn">
                  <i class="ph ph-download-simple"></i> <span data-i18n="bs.btn_download">Download</span>
                </button>
              </div>
              <div class="ai-reply-row" id="aiReplyRow" hidden>
                <p id="aiReply" class="ai-reply"></p>
                <button type="button" id="aiReplySpeakButton" class="secondary ai-reply-speak" data-i18n-title="bs.play_summary_title" title="Play summary">
                  <i class="ph ph-speaker-high" style="font-size:15px" aria-hidden="true"></i>
                </button>
              </div>

              <div class="reference-toolbar">
                <h3><i class="ph ph-images"></i> <span data-i18n="bs.heading_references">References</span> <span id="referenceMeta" class="ref-count"></span></h3>
                <div class="reference-actions">
                  <button type="button" id="recentButton" class="ref-action-link" hidden><i class="ph ph-clock-counter-clockwise"></i> <span data-i18n="bs.btn_recent">Recent</span></button>
                  <button type="button" id="clearRefsButton" class="ref-action-link" hidden><i class="ph ph-trash"></i> <span data-i18n="bs.btn_clear_all">Clear all</span></button>
                </div>
              </div>
              <div id="referenceGallery" class="gallery" aria-live="polite"></div>

              <div class="recent-popup" id="recentPopup" hidden>
                <div class="recent-popup-header">
                  <span><i class="ph ph-clock-counter-clockwise"></i> <span data-i18n="bs.btn_recent">Recent</span></span>
                  <button type="button" id="recentCloseButton" class="recent-popup-close">&times;</button>
                </div>
                <div id="recentGallery" class="gallery"></div>
              </div>
            </section>
          </div>
        </div>
      </section>
    </main>

    <section class="lightbox" id="lightbox" hidden>
      <div class="lightbox-bar">
        <p id="lightboxTitle" data-i18n="bs.lightbox_title">Image viewer</p>
        <div class="lightbox-actions">
          <button type="button" id="zoomOutButton" class="secondary"><i class="ph ph-minus"></i></button>
          <button type="button" id="zoomResetButton" class="secondary">100%</button>
          <button type="button" id="zoomInButton" class="secondary"><i class="ph ph-plus"></i></button>
          <button type="button" id="lightboxDownloadButton" class="secondary">
            <i class="ph ph-download-simple"></i> <span data-i18n="bs.btn_save">Save</span>
          </button>
          <button type="button" id="lightboxPrevButton" class="secondary"><i class="ph ph-caret-left"></i></button>
          <button type="button" id="lightboxNextButton" class="secondary"><i class="ph ph-caret-right"></i></button>
          <button type="button" id="lightboxCloseButton" class="danger"><i class="ph ph-x"></i></button>
        </div>
      </div>
      <div class="lightbox-canvas" id="lightboxCanvas">
        <img id="lightboxImage" alt="Full size preview" draggable="false" />
      </div>
    </section>

    <section class="voice-popup" id="voicePopup" hidden>
      <div class="voice-popup-card">
        <h3><i class="ph ph-microphone"></i> <span data-i18n="bs.voice_title">Talk me through your image</span></h3>
        <p class="voice-popup-meta" data-i18n="bs.voice_meta">Describe your idea naturally. We auto-send after a short silence, or you can send immediately.</p>
        <div class="voice-live-strip">
          <canvas id="voiceWaveCanvas" width="640" height="56" aria-hidden="true"></canvas>
        </div>
        <div class="voice-analytics-row">
          <canvas id="voiceBandsCanvas" width="320" height="42" aria-hidden="true"></canvas>
          <canvas id="voiceLoudnessCanvas" width="320" height="42" aria-hidden="true"></canvas>
        </div>
        <p class="voice-popup-note" id="voicePopupNote" data-i18n="bs.voice_listening">Listening...</p>
        <div class="voice-popup-actions">
          <button type="button" id="voiceSendButton" class="secondary"><i class="ph ph-paper-plane-tilt"></i> <span data-i18n="bs.btn_send_now">Send now</span></button>
          <button type="button" id="voiceCancelButton" class="danger"><i class="ph ph-x"></i> <span data-i18n="bs.btn_cancel">Cancel</span></button>
        </div>
      </div>
    </section>

    <section class="download-format-popup" id="downloadFormatPopup" hidden>
      <div class="download-format-card">
        <div class="download-format-header">
          <h3 data-i18n="bs.download_format_title">Download Format</h3>
          <button type="button" id="downloadFormatCloseButton" class="download-format-close">&times;</button>
        </div>
        <div class="download-format-options">
          <button type="button" id="downloadSvgButton" class="download-format-btn">
            <i class="ph ph-file-svg"></i>
            <span class="download-format-btn-label" data-i18n="bs.download_svg_label">SVG</span>
            <span class="download-format-btn-hint" data-i18n="bs.download_svg_hint">Scalable, editable</span>
          </button>
          <button type="button" id="downloadPngButton" class="download-format-btn">
            <i class="ph ph-file-png"></i>
            <span class="download-format-btn-label" data-i18n="bs.download_png_label">PNG</span>
            <span class="download-format-btn-hint" data-i18n="bs.download_png_hint">Raster, universal</span>
          </button>
        </div>
      </div>
    </section>
    </div>

    <script src="/static/i18n.js"></script>
    <script src="/static/app.js" defer></script>
  </body>
</html>
